{"version":"1.146.0","results":[{"check_id":"python.lang.security.deserialization.pickle.avoid-pickle","path":"sample/workflow_engine_vuln.py","start":{"line":243,"col":28,"offset":7290},"end":{"line":243,"col":42,"offset":7304},"extra":{"metavars":{"$FUNC":{"start":{"line":243,"col":35,"offset":7297},"end":{"line":243,"col":39,"offset":7301},"abstract_content":"load"}},"message":"Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.","metadata":{"owasp":["A08:2017 - Insecure Deserialization","A08:2021 - Software and Data Integrity Failures"],"cwe":["CWE-502: Deserialization of Untrusted Data"],"references":["https://docs.python.org/3/library/pickle.html"],"category":"security","technology":["python"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Insecure Deserialization "],"source":"https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle","shortlink":"https://sg.run/OPwB","semgrep.dev":{"rule":{"origin":"community","r_id":9675,"rule_id":"EwU2BJ","rv_id":946397,"url":"https://semgrep.dev/playground/r/w8TKJL9/python.lang.security.deserialization.pickle.avoid-pickle","version_id":"w8TKJL9"}}},"severity":"WARNING","fingerprint":"d6326c12d772cdf0ac02e8a52af04a5314d6bc4d04e4f77decdfdf80e34ea5f3d1786cc5cd594ed94d3ba3f4d5f5a7e6ece5e26f64b0d78b472537a16b8e7556_0","lines":"                    data = pickle.load(f)  # VULN","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.deserialization.pickle.avoid-pickle","path":"sample/workflow_engine_vuln.py","start":{"line":257,"col":17,"offset":7833},"end":{"line":257,"col":41,"offset":7857},"extra":{"metavars":{"$FUNC":{"start":{"line":257,"col":24,"offset":7840},"end":{"line":257,"col":28,"offset":7844},"abstract_content":"dump"}},"message":"Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.","metadata":{"owasp":["A08:2017 - Insecure Deserialization","A08:2021 - Software and Data Integrity Failures"],"cwe":["CWE-502: Deserialization of Untrusted Data"],"references":["https://docs.python.org/3/library/pickle.html"],"category":"security","technology":["python"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Insecure Deserialization "],"source":"https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle","shortlink":"https://sg.run/OPwB","semgrep.dev":{"rule":{"origin":"community","r_id":9675,"rule_id":"EwU2BJ","rv_id":946397,"url":"https://semgrep.dev/playground/r/w8TKJL9/python.lang.security.deserialization.pickle.avoid-pickle","version_id":"w8TKJL9"}}},"severity":"WARNING","fingerprint":"005a0519e5eb0b54449e1a116f6b8c3d05d5df8dbedda9a8c6bec9207b01cda056667c94d287e8056ca3602d76c09504aca25ed1f3cc1bd39d5589692abc6d38_0","lines":"                pickle.dump(self._kv, f)  # VULN","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.non-literal-import.non-literal-import","path":"sample/workflow_engine_vuln.py","start":{"line":348,"col":31,"offset":11573},"end":{"line":348,"col":64,"offset":11606},"extra":{"metavars":{"$NAME":{"start":{"line":348,"col":55,"offset":11597},"end":{"line":348,"col":63,"offset":11605},"abstract_content":"mod_name"}},"message":"Untrusted user input in `importlib.import_module()` function allows an attacker to load arbitrary code. Avoid dynamic values in `importlib.import_module()` or use a whitelist to prevent running untrusted code.","metadata":{"owasp":["A01:2021 - Broken Access Control"],"cwe":["CWE-706: Use of Incorrectly-Resolved Name or Reference"],"category":"security","technology":["python"],"references":["https://owasp.org/Top10/A01_2021-Broken_Access_Control"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/python.lang.security.audit.non-literal-import.non-literal-import","shortlink":"https://sg.run/y6Jk","semgrep.dev":{"rule":{"origin":"community","r_id":12068,"rule_id":"AbUGN5","rv_id":946372,"url":"https://semgrep.dev/playground/r/GxTP7eW/python.lang.security.audit.non-literal-import.non-literal-import","version_id":"GxTP7eW"}}},"severity":"WARNING","fingerprint":"2d52d257810393651cb52756fb0dc4c56dd383066eef474d98d1f614e147d80ff9212f04e14fc77c91d82292c49251ddc82c311ddc495ce8d2a942e4b61680ca_0","lines":"                        mod = importlib.import_module(mod_name)  # VULN: attacker-controlled import","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.audit.eval-detected.eval-detected","path":"sample/workflow_engine_vuln.py","start":{"line":356,"col":31,"offset":12016},"end":{"line":356,"col":109,"offset":12094},"extra":{"metavars":{},"message":"Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.","metadata":{"source-rule-url":"https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval","cwe":["CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"],"owasp":["A03:2021 - Injection"],"asvs":{"control_id":"5.2.4 Dyanmic Code Execution Features","control_url":"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements","section":"V5: Validation, Sanitization and Encoding Verification Requirements","version":"4"},"category":"security","technology":["python"],"references":["https://owasp.org/Top10/A03_2021-Injection"],"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Code Injection"],"source":"https://semgrep.dev/r/python.lang.security.audit.eval-detected.eval-detected","shortlink":"https://sg.run/ZvrD","semgrep.dev":{"rule":{"origin":"community","r_id":9635,"rule_id":"gxU149","rv_id":946341,"url":"https://semgrep.dev/playground/r/xyTqnr7/python.lang.security.audit.eval-detected.eval-detected","version_id":"xyTqnr7"}}},"severity":"WARNING","fingerprint":"e7527f98551953983a14ae59420635ce0ac73ec8355cf836e2d5f80002d11f5b358fb85e02d55a91d2f0875851ba75c874f13d6ab51b22f21a71a01eec9d32d6_0","lines":"                        val = eval(spec.python_expr, {\"ctx\": ctx, \"os\": os, \"time\": time, \"random\": random})  # VULN","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.deserialization.pickle.avoid-pickle","path":"sample/workflow_engine_vuln.py","start":{"line":466,"col":27,"offset":16356},"end":{"line":466,"col":59,"offset":16388},"extra":{"metavars":{"$FUNC":{"start":{"line":466,"col":34,"offset":16363},"end":{"line":466,"col":39,"offset":16368},"abstract_content":"dumps"}},"message":"Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.","metadata":{"owasp":["A08:2017 - Insecure Deserialization","A08:2021 - Software and Data Integrity Failures"],"cwe":["CWE-502: Deserialization of Untrusted Data"],"references":["https://docs.python.org/3/library/pickle.html"],"category":"security","technology":["python"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Insecure Deserialization "],"source":"https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle","shortlink":"https://sg.run/OPwB","semgrep.dev":{"rule":{"origin":"community","r_id":9675,"rule_id":"EwU2BJ","rv_id":946397,"url":"https://semgrep.dev/playground/r/w8TKJL9/python.lang.security.deserialization.pickle.avoid-pickle","version_id":"w8TKJL9"}}},"severity":"WARNING","fingerprint":"a35a08d6a79ddc0bd905cfbb75828978d0ae4f00038e293572af71889898e2feb6d35724b072c84296ef5e565fd294a2ad71ef89cc67b24c67744d1b5e923c4a_0","lines":"    ctx.kv[\"user_blob\"] = pickle.dumps({\"hello\": \"world\"})  # sink for later","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.lang.security.deserialization.pickle.avoid-pickle","path":"sample/workflow_engine_vuln.py","start":{"line":475,"col":11,"offset":16643},"end":{"line":475,"col":29,"offset":16661},"extra":{"metavars":{"$FUNC":{"start":{"line":475,"col":18,"offset":16650},"end":{"line":475,"col":23,"offset":16655},"abstract_content":"loads"}},"message":"Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.","metadata":{"owasp":["A08:2017 - Insecure Deserialization","A08:2021 - Software and Data Integrity Failures"],"cwe":["CWE-502: Deserialization of Untrusted Data"],"references":["https://docs.python.org/3/library/pickle.html"],"category":"security","technology":["python"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Insecure Deserialization "],"source":"https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle","shortlink":"https://sg.run/OPwB","semgrep.dev":{"rule":{"origin":"community","r_id":9675,"rule_id":"EwU2BJ","rv_id":946397,"url":"https://semgrep.dev/playground/r/w8TKJL9/python.lang.security.deserialization.pickle.avoid-pickle","version_id":"w8TKJL9"}}},"severity":"WARNING","fingerprint":"c20c2686a58bfc5c6e6616ffec2aa5d6c7fce70f6e3d2733741f8f366277392bc5644013356953941172489b48a617bad82c16b50c7c9d6494601c508b5f8ffa_0","lines":"    obj = pickle.loads(blob)  # VULN","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["sample/workflow_engine_vuln.py"]},"time":{"rules":[],"rules_parse_time":5.414387941360474,"profiling_times":{"config_time":6.232454776763916,"core_time":6.912766933441162,"ignores_time":0.0015139579772949219,"total_time":13.152549743652344},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":1.1443791389465332,"per_file_time":{"mean":0.38145971298217773,"std_dev":0.28790654789042947},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9914255091103966,"rules_selected_ratio":0.14362272240085744,"rules_matched_ratio":0.14362272240085744},"targets":[],"total_bytes":0,"max_memory_bytes":9272983552},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[],"profiling_results":[]}
